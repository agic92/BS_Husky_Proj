V 13
4
LANG:10024 9 infoPanel
LANG:10027 20 Инфопанель
LANG:10000 9 InfoPanel
LANG:10001 9 infoPanel
PANEL,-1 -1 1600 1035 N "_3DFace" 0
"#uses \"mapiranje_detektora.ctl\"
#uses \"latin_to_cyrillic.ctl\"

bool provjera;
main()
{
  setValue(\"_QuickTest_.MAIN_PANELI/Konzola.pnl:btn_back\", \"visible\", true);

//  inicijaliziramo postavke za alarme sa imenom sistema
  string a,c;
  a=myManNum();
  c=myModuleName();
  dyn_string sistemi;  
  dynClear(sistemi);
  dynAppend(sistemi,\"SysSarani\");
//   addGlobal(\"sys_name\", STRING_VAR);
//   sys_name = \"SysSarani:\";  
  //dynAppend(sistemi,\"SysGrabosjec\");
  //dynAppend(sistemi,\"SysSuhodol\");
  //dynAppend(sistemi,\"System1\");
  //dynAppend(sistemi,\"SysBijelaVlaka\");
  //dynAppend(sistemi,\"SysVijenac\");
  //dynAppend(sistemi,\"SysSarani\");
  
  dpSet (\"SysSarani:_AESPropertiesRTRow_\" + a + \"_\"+c + \"_Top.Name\",\"aes_propSarani\");
  
  //dpQueryConnectSingle(\"work\", 1, \"ident\", \"SELECT ALERT '_alert_hdl.._ackable' FROM '*' \", 500);
  
  //DebugN(\"SysSarani:_AESPropertiesRTRow_\" + a + \"_\" + c + \"_Top.Name\");
}




work(string ident, dyn_dyn_anytype tab)
{
 //delay(1);
 bool blok;
 dpGet(\"SysSarani:\"+\"ime.Alarm.blok:_online.._value\", blok);
 if (!blok){
    dpSet(\"SysSarani:\"+\"ime.Alarm.dpElement\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.tip\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.objekat\",\"00\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.opis\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijednost\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.lazni\",0);
    PanelOffPanel(\"IzborScenarija\");
    sdShowBitmap(\"RECTANGLE3\",1,TRUE,\"crna.jpg\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.zadnji\",1);}
    DebugN(\"work\");
}

" 0
 E E E E 1 -1 -1 0  350 60
""0  1
E E 3
"CBRef" "0"
"EClose" E
"dpi" "96.1514"
0 0 0
""
NC
DISPLAY_LAYER, 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
LAYER, 0 
2
LANG:10024 6 Layer1
LANG:10027 6 Layer1
1 672 0 "" 8
0
25 468
"TABLE1"
""
1 31 116 E E E 0 E 1 E N "_WindowText" E N "_Window" E E
 E E
291 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

0
3
LANG:10024 26 Arial,-1,12,5,50,0,0,0,0,0
LANG:10027 26 Arial,-1,12,5,50,0,0,0,0,0
LANG:10001 26 Arial,-1,12,5,50,0,0,0,0,0
0  29 114 917 142
EE 1 0 1 9 0 "#1" 7 1 0 "s" 3
LANG:10024 10 Tip alarma
LANG:10027 19 Тип аларма
LANG:10001 10 Tip alarma
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

74 "#2" 17 1 0 "s" 3
LANG:10024 12 Vreme alarma
LANG:10027 23 Време аларма
LANG:10001 14 Vrijeme alarma
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

162 "#3" 24 1 0 "s" 3
LANG:10024 19 Objekat pod alarmom
LANG:10027 34 Обекат под алармом
LANG:10001 19 Objekat pod alarmom
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

232 "#4" 16 1 0 "s" 3
LANG:10024 11 Opis alarma
LANG:10027 21 Опис аларма
LANG:10001 11 Opis alarma
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

152 "#5" 4 1 0 "s" 3
LANG:10024 6 Stanje
LANG:10027 10 Стање
LANG:10001 6 Stanje
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

44 "#6" 6 1 0 "s" 3
LANG:10024 8 Vrednost
LANG:10027 16 Вредност
LANG:10001 10 Vrijednost
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

63 "#7" 2 1 0 "s" 3
LANG:10024 1 P
LANG:10027 2 П
LANG:10001 1 P
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

31 "#8" 13 1 0 "s" 3
LANG:10024 13 Vreme potvrde
LANG:10027 25 Време потврде
LANG:10001 15 Vrijeme potvrde
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

128 "#9" 3 1 0 "s" 3
LANG:10024 3 Kom
LANG:10027 6 Ком
LANG:10001 3 Kom
E
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

38 
6 6 10 0
3
LANG:10024 26 Arial,-1,12,5,50,0,0,0,0,0
LANG:10027 26 Arial,-1,12,5,50,0,0,0,0,0
LANG:10001 26 Arial,-1,12,5,50,0,0,0,0,0
0 0 0 0 4 7
1 0
2 469
"PRIMITIVE_TEXT1"
""
1 490 50 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
292 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 0 1 1 2 1 E U  0 E 417 50 563 70
0 2 2 "0s" 0 0 0 193 0 0  490 50 1
3
LANG:10024 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10027 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10001 26 Arial,-1,19,5,75,0,0,0,0,0
0 3
LANG:10024 15 Alarmna tabela:
LANG:10027 28 Алармна табела:
LANG:10001 15 Alarmna tabela:
6 510
"slika_sa_kamere"
""
1 1395 820 E E E 1 E 1 E N {0,0,0} E N "STD_text" E E
 E E
331 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
"//10.101.0.1/TakovoPreljina/pictures///10.101.0.1/TakovoPreljina/pictures/AID/// SimpleCtrlScriptStart {invalid}
main()
{
  EP_setSlika();
}

void EP_setSlika()
{
  int rc;
  string sys_name = \"SysSarani:\";
  
  if( !dpExists( sys_name + \"ime.Alarm.objekat:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_setSlikaCB\", sys_name+\"ime.Alarm.objekat:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_setSlikaCB(string dpSource, string sNewValue)
{
  string sys_name = \"SysSarani:\";
  DebugTN(\"objekat: \" + sNewValue);     
  //sNewValue=(substr(sNewValue,0,strpos(sNewValue,\":\")+1)+substr(sNewValue,strpos(sNewValue,\"/\")+2));
  sdShowBitmap(\"\",1,TRUE,\"crna.jpg\");    
  string provjera,kamera,ispred, opis;

  dpGet(sys_name + \"ime.Alarm.opis\", opis);
  if (opis==\"Pesak\")
    opis=\".Pedestrian\";
  else if (opis==\"Dim\")
    opis=\".Smoke\";
  else if (opis==\"Suprotan smer\")
    opis=\".Ghost_driver\";
  else if (opis==\"Zaustavljeno vozilo\")
    opis=\".Stopped_vehicle\";
  else if (opis==\"Saobracajna guzva\")
    opis=\".Traffic_jam\";
  else if (opis==\"Kretanje u ugibalistu\")
    opis=\".Movement_in_non-traffic_area\";
  else if (opis==\"Strani objekat\")
    opis=\".Lost_cargo\";
  else if (opis==\"Naglo skretanje\")
    opis=\".False_driver\";

  //sNewValue=(sNewValue+opis);
          
  DebugN(\"novi string \",sNewValue);  
  
  
  string provjera,kamera,ispred;
  int pos;
  pos=strpos(sNewValue, \":\",0);
  provjera=substr(sNewValue,pos+1,1);

  //DebugTN(\"PROVJERA  aaaa  \",provjera);
  if(provjera==\"K\")
  {
      //ucitaj na svaku promjenu kamere
    sdShowBitmap(\"\",1,TRUE,\"load.jpg\"); 
    bool zadnji_enabled, blok;
    dpGet(\"SysSarani:ime.Alarm.zadnji\", zadnji_enabled, \"SysSarani:ime.Alarm.blok\", blok);
    
    
    int i=0;
 
    while(sNewValue[i]!=\".\")
    {
      i++;
    }
    kamera=substr(sNewValue,0,i);    
    //string nazivKamere = substr(kamera,pos+1,i-(pos+1)); 
    
    string nazivSlike;
    
    dpGet(kamera + \".Imena_slika\" + opis, nazivSlike);    
   
    
    if (zadnji_enabled && !blok) {
      if (isfile(\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\")) {
        sdShowBitmap(\"\",1,true,\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\");
      } 
      else {
        delay(1, 500);
        if (isfile(\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\")) {
          sdShowBitmap(\"\",1,true,\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\");
        } 
      }
    }    
    
    
    DebugTN(\"Naziv slike\", nazivSlike);
    
    if (isfile(\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\")) {
      sdShowBitmap(\"\",1,true,\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\");
    }      
         
//     EP_setNazivKamere(kamera);
//     delay(1);
//         
//     sdShowBitmap(\"\",1,true,\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\");
//         
//     EP_setNazivKamere(kamera);
//     delay(1);
//        
//     sdShowBitmap(\"\",1,true,\"//10.101.0.1/TakovoPreljina/pictures/AID/\"+nazivSlike+\".jpg\");
//     EP_setNazivKamere(kamera); 
    
  }

}

void EP_setNazivKamere(string kamera) {
  // Text polje iznad slike, koje ispisuje naziv kamere.
  tekst_za_sliku_sa_kamere.text(kamera);
}" 0
 E 0 1 1 2 1 E 1.765134529732958 0 2.259384160990984 -1538.592799974314 -1293.384177522096 1 E 1395 820 1757 1032
13 523
"btn_odmiljavanje_ulaz"
""
1 1124.696330795627 880 E E E 1 E 0 E N "WF_Text" E N "_Button" E E
 E E
332 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1322 407 1490 471

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrdaOdimljavanja.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$SMJER:\" + 1), 50, -90);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Pokreni odimljavanje \\nu smjeru suprotnom\\nsmjeru saobraćaja\");
}" 0

13 524
"btn_odmiljavanje_izlaz"
""
1 1033.852277789185 646.8333333333334 E E E 1 E 0 E N "WF_Text" E N "_Button" E E
 E E
333 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  996 407 1164 471

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrdaOdimljavanja.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$SMJER:\" + 0), 50, -90);
}" 0
 E E E
2 525
"tekst_za_sliku_sa_kamere"
""
1 1253.827332064481 516.9444444444441 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
334 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 0 1 1 2 1 E U  0 E 1253.827332064481 516.9444444444441 1255 537
0 2 2 "0s" 0 0 0 193 0 0  1253.827332064481 516.9444444444441 1
3
LANG:10024 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10027 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10001 26 Arial,-1,19,5,75,0,0,0,0,0
0 3
LANG:10024 0 
LANG:10027 0 
LANG:10001 36 Slika sa incidentne kamere u fokusu:
6 526
"RECTANGLE15"
""
1 1390 220 E E E 1 E 1 E N "_Transparent" E N "_Transparent" E E
 E E
335 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
"#uses \"mapiranjeBrojevaScenarija.ctl\"

main()
{
  dpConnect(\"work\", \"SysSarani:ime.Alarm.objekat:_online.._value\", \"SysSarani:aktivni_algoritam.pokrenuti_algoritam\", 
                    \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.provjera_prisustva_start\");
 
  btn_odmiljavanje_izlaz.text = latinToCyrillic(\"Pokreni odimljavanje \\nu smjeru saobraćaja\");
  dpConnect(\"work2\", \"SysSarani:CLC.incidentni_rezim.odimljavanje_dozvoljeno\", \"SysSarani:aktivni_algoritam.pokrenuti_algoritam\");
}

work2(string dp, bool odimljavanje_dozvoljeno, string dp2, int algoritam) {
 if (odimljavanje_dozvoljeno && algoritam >= 1 && algoritam <= 17) {
    btn_odmiljavanje_izlaz.visible = true;
    btn_odmiljavanje_ulaz.visible = true;
 }
 else {
    btn_odmiljavanje_izlaz.visible = false;
    btn_odmiljavanje_ulaz.visible = false;
 }
}


work (string dp1, string objekat, string dp2, int pokrenutiAlgoritam, string dp3, bool pokrenuta_provjera_prisustva) {
  
  if (pokrenutiAlgoritam == 0 && !pokrenuta_provjera_prisustva) {
    btnNormalni.visible = false;
      
    string dp = dpSubStr(objekat, DPSUB_SYS_DP); //popravi ovo
    int kategorijaAlarma;
    dyn_int brojeviScenarija;
    //dpGet(dp + \".kategorijaAlarma\" , kategorijaAlarma);
    //PRIMITIVE_TEXT8.text = kategorijaAlarma; //dp + \".kategorijaAlarma : \" + kategorijaAlarma;
    if(dpExists(dp + \".kategorijaAlarma\")) {
      dpGet(dp + \".kategorijaAlarma\" , kategorijaAlarma);
  
      switch(kategorijaAlarma) {
        case 1: //pozar sa pozarnih detektora
          slika_sa_kamere.visible = false;
          tekst_za_sliku_sa_kamere.visible = false;
          brojeviScenarija = alarmSaPozarnihDetektora(dp, objekat);
          break;
      
        case 2:  //detekcija sa kamere
          slika_sa_kamere.visible = true;
          tekst_za_sliku_sa_kamere.visible = true;
          brojeviScenarija = alarmSaKamere(objekat, dp);
          break;
      
        case 3:  //podaci sa meteostanice
          slika_sa_kamere.visible = false;
          tekst_za_sliku_sa_kamere.visible = false;
          //brojeviScenarija = alarmSaMeteostanice(dp);      
          break;
        
        case 4: //podaci sa brojaca prometa
          slika_sa_kamere.visible = false;
          tekst_za_sliku_sa_kamere.visible = false;
          //brojeviScenarija = alarmSaBrojacaPrometa(dp);
          break;
        case 5: //podaci sa senzora CO i senzora vidljivost
          slika_sa_kamere.visible = false;
          tekst_za_sliku_sa_kamere.visible = false;
          brojeviScenarija = alarmSaSenzora(dp, objekat);
          break;
        default:
          slika_sa_kamere.visible = false;
          tekst_za_sliku_sa_kamere.visible = false;
          brojeviScenarija = makeDynInt(-1);
      }
    }
    else {
      slika_sa_kamere.visible = false;
      tekst_za_sliku_sa_kamere.visible = false;
      brojeviScenarija = makeDynInt(-1);
      
    }
  
    dyn_string naziviScenarija = getNaziviScenarija(brojeviScenarija);
    dpSet(\"SysSarani:aktivni_algoritam.predlozeni_algoritmi\", brojeviScenarija);
  
    prilagodiIzgled(naziviScenarija);
  }
  else {
    
    if (!pokrenuta_provjera_prisustva) {
      sakrijPrijedlogAlgoritama();
      btnNormalni.visible = true;
    }
    else {
      btnNormalni.visible = false;
    }
    slika_sa_kamere.visible = false;
  }
}

dyn_int alarmSaMeteostanice(string objekat, string dp) {
  
  string alarm = substr(objekat, strpos(objekat, \".\") + 16); //npr: SysSarani:MS2.response.alarm.Snijeg --> trazi prvu tacku i pomjera
  int scenarij;                                                          //za 16 mjesta naprijed, da dodje do naziva alarma
  int vidljivost, visina_vodenog_sloja, vjetar;
  switch(alarm) {
    case \"Snijeg\":
      scenarij = 27;
      break;
    case \"Magla\":
      
      dpGet(objekat, vidljivost);
      if (vidljivost > 60 && vidljivost <= 100) {
        scenarij = 24;
      }
      else if (vidljivost <= 60) {
        scenarij = 25;
      }
      break;
    case \"Sklizak_Kolovoz\":
      dpGet(objekat, visina_vodenog_sloja);
      if (visina_vodenog_sloja >= 1500 && visina_vodenog_sloja < 3000) {
        scenarij = 22;
      }
      else if (visina_vodenog_sloja >= 3000){
        scenarij = 23;
      }
      break;
    case \"Poledica\":
      scenarij = 26;
      break;
    case \"Vjetar\":
      dpGet(objekat, vjetar);
      if (vjetar>=18 && vjetar <22) {
        scenarij = 29;
      }
      else if (vjetar >=22) {
        scenarij = 30;
      }
      break;
    default:
      scenarij = -1;
  }
  
  return makeDynInt(scenarij);
}
  

dyn_int alarmSaPozarnihDetektora (string dp, string objekat) {
  int vatrodojavnaZona;
  dpGet(dp + \".zona\", vatrodojavnaZona);
  
  if (strpos(objekat, \"alarm\") >= 0 || strpos(objekat, \"Fire\") >= 0) {//da se ne bi okidali algoritmi za alarm greske ili iskljucenja uredjaja
    return makeDynInt(vatrodojavnaZona, 39); //ovo ce biti i broj scenarija, zona 1 = scenarij broj 1 itd. 
  }                                          //mapiranja su uradjena u /scripts/libs/mapiranjeBrojevaScenarija.ctl
  else {
    return makeDynInt(-1);
  } 
}

dyn_int alarmSaSenzora(string dp, string objekat) {
  string cijev;
  dpGet(dp + \".cijev\", cijev);
  
  int scenarij;
  if (strpos(objekat, \"kvar\") >= 0) {
    scenarij = -1;
  }
  else {
    if (cijev == \"desna\")
      scenarij = 48;
    else if (cijev == \"lijeva\")
      scenarij = 48;
    else 
      scenarij = -1;  
  }
  return makeDynInt(scenarij);
}


dyn_int alarmSaKamere(string objekat, string dp) {
  dyn_int scenariji;
  string alarm = substr(objekat, strpos(objekat, \".\") + 1);
  int vatrodojavnaZona;
  string cijev;
  dpGet(dp + \".cijev\", cijev);
  
  switch(alarm)  {
    case \"Pedestrian\":
    case \"Lost_cargo\":
    case \"Stopped_vehicle\":
      scenariji = (cijev==\"desna\") ? makeDynInt(18, 19, 35) : makeDynInt(20, 21, 36);
      break;
      
    case \"Ghost_driver\":
      scenariji = (cijev==\"desna\") ? makeDynInt(38) : makeDynInt(37);
      break;
      
    case \"Traffic_jam\":
      scenariji = (cijev==\"desna\") ? makeDynInt(31, 32) : makeDynInt(33, 34);
      break;
    
    case \"Smoke\":
      dpGet(dp + \".zona\", vatrodojavnaZona);
      scenariji = makeDynInt(vatrodojavnaZona);
	  break;
    case \"otvorena_vrata_nise\":
      slika_sa_kamere.visible = false;
      scenariji = makeDynInt(-1);
      break;
    default: 
        scenariji = makeDynInt(-1);
      break;
  }
  return scenariji;
}

prilagodiIzgled(dyn_string naziviScenarija) {
  switch(dynlen(naziviScenarija)) {
      case 0:
        sakrijPrijedlogAlgoritama();
        break;
      case 1:
        if (naziviScenarija[1]!=\" \") {
          txt_prijedlog_scenarija.visible = true;
          
          txt1.visible = true;
          txt1.text = naziviScenarija[1];
          btn1.visible = true;
          txt2.visible = false;
          btn2.visible = false;
          txt3.visible = false;
          btn3.visible = false;
        
          l1.visible = true;
          l2.visible = true;
          l11.visible = true;
          l12.visible = true;
          l3.visible = false;
          l21.visible = false;
          l22.visible = false;
          l4.visible = false;
          l31.visible = false;
          l32.visible = false;
        }
        else
          sakrijPrijedlogAlgoritama();
        break;
      case 2:
        txt_prijedlog_scenarija.visible = true;
        txt1.visible = true;
        txt1.text = naziviScenarija[1];
        btn1.visible = true;
        txt2.visible = true;
        txt2.text = naziviScenarija[2];
        btn2.visible = true;
        txt3.visible = false;
        btn3.visible = false;
        
        l1.visible = true;
        l2.visible = true;
        l11.visible = true;
        l12.visible = true;
        l3.visible = true;
        l21.visible = true;
        l22.visible = true;
        l4.visible = false;
        l31.visible = false;
        l32.visible = false;
        break;
      case 3:
        txt_prijedlog_scenarija.visible = true;
        txt1.visible = true;
        txt1.text = naziviScenarija[1];
        btn1.visible = true;
        txt2.visible = true;
        txt2.text = naziviScenarija[2];
        btn2.visible = true;
        txt3.visible = true;
        txt3.text = naziviScenarija[3];
        btn3.visible = true;
        
        l1.visible = true;
        l2.visible = true;
        l11.visible = true;
        l12.visible = true;
        l3.visible = true;
        l21.visible = true;
        l22.visible = true;
        l4.visible = true;
        l31.visible = true;
        l32.visible = true;
        break;
      default:
        sakrijPrijedlogAlgoritama();
        break;
    }
}


void sakrijPrijedlogAlgoritama () {
      txt_prijedlog_scenarija.visible = false;
      txt1.visible = false;
      btn1.visible = false;
      txt2.visible = false;
      btn2.visible = false;
      txt3.visible = false;
      btn3.visible = false;
        
      l1.visible = false;
      l2.visible = false;
      l11.visible = false;
      l12.visible = false;
      l3.visible = false;
      l21.visible = false;
      l22.visible = false;
      l4.visible = false;
      l31.visible = false;
      l32.visible = false;
}
" 0
 E 1 1 3 2 1 E 1.416666666666668 0 1.389473684210526 -980.9074477818415 -134.2397660818711 1 E 1390 220 1750 410
2 527
"txt_prijedlog_scenarija"
""
1 1242.881556355244 151.7777777777779 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
336 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "1"
"main()
{
  this.text = latinToCyrillic(\"Predloženi algoritmi upravljanja:\");
}" 0
 E 0 1 1 2 1 E U  0 E 1242.881556355244 151.7777777777779 1244 172
0 2 2 "0s" 0 0 0 193 0 0  1242.881556355244 151.7777777777779 1
3
LANG:10024 36 Liberation Sans,-1,19,5,75,0,0,0,0,0
LANG:10027 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10001 26 Arial,-1,19,5,75,0,0,0,0,0
0 3
LANG:10024 0 
LANG:10027 66 Понуђени сценариј за аларм у фокусу:
LANG:10001 37 Ponuđeni scenarij za alarm u fokusu:
2 528
"txt1"
""
1 1011.748568766492 206.9444444444445 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
337 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 3 2 1 E U  0 E 1011.748568766492 206.9444444444445 1013 221
0 2 2 "0s" 0 0 0 192 0 0  1011.748568766492 206.9444444444445 1
2
LANG:10024 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
LANG:10027 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 529
"btn1"
""
1 1037.259218884828 507.9444444444445 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
338 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1181 225 1305 265

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrda_algoritma.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 1), 50, -90);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Pokreni \\nalgoritam\");
}" 0

2 530
"txt2"
""
1 1011.748568766492 277.9444444444445 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
339 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 3 2 1 E U  0 E 1011.748568766492 277.9444444444445 1013 292
0 2 2 "0s" 0 0 0 192 0 0  1011.748568766492 277.9444444444445 1
2
LANG:10024 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
LANG:10027 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 531
"btn2"
""
1 1184.259218884828 303.0353535353536 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
340 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1183 291 1304 335

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrda_algoritma.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 2), 50, -90);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Pokreni \\nalgoritam\");
}" 0

2 532
"txt3"
""
1 1004.086550949309 354.4444444444446 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
341 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 3 2 1 E U  0 E 1004.086550949309 354.4444444444446 1006 368
0 2 2 "0s" 0 0 0 192 0 0  1004.086550949309 354.4444444444446 1
2
LANG:10024 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
LANG:10027 36 Liberation Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 533
"btn3"
""
1 1037.759218884828 523.9444444444445 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
342 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1182 371 1306 411

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrda_algoritma.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 3), 50, -90);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Pokreni \\nalgoritam\");
}" 0

4 534
"l2"
""
1 988.259218884827 269.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
343 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 269.9444444444445 1498.259218884828 269.9444444444445
4 535
"l3"
""
1 988.259218884827 339.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
344 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 339.9444444444445 1498.259218884828 339.9444444444445
4 536
"l4"
""
1 988.259218884827 413.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
345 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 413.9444444444445 1498.259218884828 413.9444444444445
4 537
"l1"
""
1 988.259218884827 196.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
346 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 196.9444444444445 1498.259218884828 196.9444444444445
4 538
"l11"
""
1 988.259218884827 196.9444444444445 E E E 1 E 1 E N "WF_Text" E N {255,255,255} E E
 E E
347 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 196.9444444444445 988.259218884827 269.9444444444445
4 539
"l12"
""
1 1498.259218884828 196.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
348 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  1498.259218884828 196.9444444444445 1498.259218884828 269.9444444444445
4 540
"l21"
""
1 988.259218884827 266.9444444444445 E E E 1 E 1 E N "WF_Text" E N {255,255,255} E E
 E E
349 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 266.9444444444445 988.259218884827 339.9444444444445
4 541
"l22"
""
1 1498.259218884828 267.4444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
350 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  1498.259218884828 267.4444444444445 1498.259218884828 340.4444444444445
4 542
"l31"
""
1 988.259218884827 339.9444444444445 E E E 1 E 1 E N "WF_Text" E N {255,255,255} E E
 E E
351 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  988.259218884827 339.9444444444445 988.259218884827 412.9444444444445
4 543
"l32"
""
1 1498.259218884828 340.9444444444445 E E E 1 E 1 E N {0,0,0} E N {255,255,255} E E
 E E
352 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 1 1 3 2 1 E  1498.259218884828 340.9444444444445 1498.259218884828 413.9444444444445
13 544
"btnNormalni"
""
1 1017.852277789185 667.9444444444445 E E E 1 E 0 E N "WF_Text" E N "_Button" E E
 E E
353 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1176 276 1311 330

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  bool auto_start;
  
  dpGet(\"SysSarani:aktivni_algoritam.rucni_javljac_parametri.zabranjen_prekid_algoritma\", auto_start);  
  if (!auto_start) {
    ChildPanelOnRelativ(\"MAIN_PANELI/potvrdaNormalnogRezima.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 1), 50, -90);
  }
  else {
    string pokretac;
    dpGet(\"SysSarani:aktivni_algoritam.pokretac_algoritma\", pokretac); 
    bool off;
    dpGet(\"SysSarani:\" + pokretac + \".Status.SwitchOff\", off);
    //DebugTN(\"SysSarani:\" + pokretac + \".Status.SwitchOff, \" + off);
    if (off) {
      ChildPanelOnRelativ(\"MAIN_PANELI/potvrdaNormalnogRezima.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 1), 50, -90);
    }
    else {
      ChildPanelOnRelativ(\"MAIN_PANELI/zabranaPrekidaAlgoritma.pnl\", latinToCyrillic(\"Upozorenje\"),makeDynString(\"$JAVLJAC:\" + pokretac), 50, -90);
    }
  }
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Zaustavi aktivni\\nalgoritam\");
}" 0

2 545
"txt_odimljavanje"
""
1 1239.759218884827 349.9444444444445 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
354 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Odimljavanje tunela u toku...\");
  dpConnect(\"work\", \"SysSarani:CLC.incidentni_rezim.odimljavanje_izlazni_portal\", \"SysSarani:CLC.incidentni_rezim.odimljavanje_ulazni_portal\");
}

work (string dp1, bool odimljavanje_izlaz, string dp2, bool odimljavanje_ulaz) {
  if (odimljavanje_izlaz || odimljavanje_ulaz) {
    this.visible = true;
  }
  else {
    this.visible = false;
  }
}" 0
 E 0 1 3 2 1 E U  0 E 1239.759218884827 349.9444444444445 1241 363
0 2 2 "0s" 0 0 0 193 0 0  1239.759218884827 349.9444444444445 1
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 558
"PRIMITIVE_TEXT3"
""
1 1253.827332064481 547.1336099539335 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
355 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 0 1 1 2 1 E U  0 E 1253.827332064481 547.1336099539335 1255 567
0 2 2 "0s" 0 0 0 193 0 0  1253.827332064481 547.1336099539335 1
3
LANG:10024 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10027 26 Arial,-1,19,5,75,0,0,0,0,0
LANG:10001 26 Arial,-1,19,5,75,0,0,0,0,0
0 3
LANG:10024 0 
LANG:10027 0 
LANG:10001 36 Slika sa incidentne kamere u fokusu:
6 559
"RECTANGLE16"
""
1 1200 650 E E E 1 E 1 E N "_Transparent" E N "_Transparent" E E
 E E
356 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  dpConnect(\"work\", \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.provjera_prisustva_start\",
                    \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.izvidjanje\",
                    \"SysSarani:aktivni_algoritam.rucni_javljac_parametri.automatski_start\",
                    \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.automatski_start\");
  
}

work (string dp1, bool provjera,
      string dp3, bool izvidjanje,
      string dp9, bool auto_start,
      string dp10, bool auto_start_automatski) {
  
  if (provjera && !izvidjanje) { //period dok se ceka potvrda operatera
    txt_timer1.visible = true;
    btn_prisustvo.visible = true;
    
    
    txt_timer2.visible = false;
    btn_hitno.visible = false;
    btn_prekid.visible = false;
    delay(1);
    sakrijPrijedlogAlgoritama();
  }
  
  else if (izvidjanje) {
    int zona;
    
    dpGet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.zona_pod_alarmom\", zona);
    dyn_int brojeviScenarija = makeDynInt(zona, 39);
    dyn_string naziviScenarija = getNaziviScenarija(brojeviScenarija);
    dpSet(\"SysSarani:aktivni_algoritam.predlozeni_algoritmi\", brojeviScenarija);
  
    prilagodiIzgled(naziviScenarija);
    txt_timer1.visible = false;
    btn_prisustvo.visible = false;
    //sakrijPrijedlogAlgoritama();
    
    txt_timer2.visible = true;
    btn_hitno.visible = true;
    btn_prekid.visible = true;
  }
  
  else {
    txt_timer1.visible = false;
    btn_prisustvo.visible = false;
    
    txt_timer2.visible = false;
    btn_hitno.visible = false;
    btn_prekid.visible = false;
    
  }
  
  if (auto_start_automatski || auto_start) {
    txt_algoritam.visible = true;
    btn_novi_algoritam.visible = true;
    sakrijPrijedlogAlgoritama();
  }
  else {
    txt_algoritam.visible = false;
    btn_novi_algoritam.visible = false;
  }
  
}

void sakrijPrijedlogAlgoritama() {
      txt_prijedlog_scenarija.visible = false;
      txt1.visible = false;
      btn1.visible = false;
      txt2.visible = false;
      btn2.visible = false;
      txt3.visible = false;
      btn3.visible = false;
        
      l1.visible = false;
      l2.visible = false;
      l11.visible = false;
      l12.visible = false;
      l3.visible = false;
      l21.visible = false;
      l22.visible = false;
      l4.visible = false;
      l31.visible = false;
      l32.visible = false;
}

prilagodiIzgled(dyn_string naziviScenarija) {
  switch(dynlen(naziviScenarija)) {
      case 2:
        txt_prijedlog_scenarija.visible = true;
        txt1.visible = true;
        txt1.text = naziviScenarija[1];
        btn1.visible = true;
        txt2.visible = true;
        txt2.text = naziviScenarija[2];
        btn2.visible = true;
        txt3.visible = false;
        btn3.visible = false;
        
        l1.visible = true;
        l2.visible = true;
        l11.visible = true;
        l12.visible = true;
        l3.visible = true;
        l21.visible = true;
        l22.visible = true;
        l4.visible = false;
        l31.visible = false;
        l32.visible = false;
        break;
      
      default:
        sakrijPrijedlogAlgoritama();
        break;
    }
}" 0
 E 1 1 3 2 1 E 1 0 1 -196.9999999999999 -99.99999999999996 1 E 1200 650 1670 920
2 560
"txt_timer1"
""
1 1255.327332064481 440.9444444444445 E E E 1 E 1 E N "Red" E N "_Window" E E
 E E
357 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  dpConnect(\"work\", \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.timer1\");
}

work (string dp, int timer) {
  string s;
  if (timer<10)
    s = \"0\";
  else 
    s=\"\";
  this.text = \"00:\" + s + timer;
}" 0
 E 0 1 3 2 1 E U  0 E 1255.327332064481 440.9444444444445 1256 552
0 2 2 "0s" 0 0 0 193 0 0  1255.327332064481 440.9444444444445 1
2
LANG:10024 34 MS Sans Serif,-1,96,5,75,0,0,0,0,0
LANG:10027 35 MS Shell Dlg 2,-1,11,5,50,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 561
"btn_prisustvo"
""
1 1188.46759162523 644.7291934632522 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
358 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 35 MS Shell Dlg 2,-1,11,5,50,0,0,0,0,0
0  1187 629 1322 683

T 
2
LANG:10024 12 PUSH_BUTTON1
LANG:10027 12 PUSH_BUTTON1
"main()
{
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.potvrdjeno_prisustvo\", 1);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Potvrdi prisustvo\\noperatera\");
}" 0

2 562
"txt_timer2"
""
1 1255.327332064481 440.9444444444445 E E E 1 E 1 E N "Red" E N "_Window" E E
 E E
359 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  dpConnect(\"work\", \"SysSarani:aktivni_algoritam.automatski_javljac_parametri.timer2\");
}

work(string dp, int timer) {
  int minut = timer/60;
  int sekunde = timer%60;
  
  string min, sec;
  
  if (minut<10)
    min = \"0\" + minut;
  else min = minut;
  if (sekunde<10) 
    sec = \"0\" + sekunde;
  else sec = sekunde;
  
  this.text = min + \":\" + sec;
}" 0
 E 0 1 3 2 1 E U  0 E 1255.327332064481 440.9444444444445 1256 552
0 2 2 "0s" 0 0 0 193 0 0  1255.327332064481 440.9444444444445 1
2
LANG:10024 34 MS Sans Serif,-1,96,5,75,0,0,0,0,0
LANG:10027 35 MS Shell Dlg 2,-1,11,5,50,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 563
"btn_prekid"
""
1 1325.208372740402 741.229193463252 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
360 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1187 629 1322 683

T 
2
LANG:10024 12 PUSH_BUTTON1
LANG:10027 12 PUSH_BUTTON1
"main()
{
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.lazni_alarm\", 1);
  
  //resetParametara();    
}

resetParametara() {
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.provjera_prisustva_start\", 0); 
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.potvrdjeno_prisustvo\", 0); 
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.timer1\", 30);
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.hitno_pokretanje\", 0);
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.izvidjanje\", 0);
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.zona_pod_alarmom\", 0);  
  delay(3);
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.lazni_alarm\", 0);
  dpSet(\"SysSarani:aktivni_algoritam.automatski_javljac_parametri.timer2\", 1200);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Označi alarm \\nkao lažni\");
}" 0

2 605
"txt_algoritam"
""
1 1252.365759960593 471.8437901948785 E E E 1 E 0 E N "red" E N "_Window" E E
 E E
390 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  dpConnect(\"work\", \"SysSarani:aktivni_algoritam.naziv_pokrenutog_algoritma\");
}

work (string dp, string algoritam) {
  this.text = latinToCyrillic(\"Automatski je pokrenut algoritam\\n\" + algoritam + \"\\nkolona vozila ispred požara\");
}" 0
 E 0 1 3 2 1 E U  0 E 1252.365759960593 471.8437901948785 1253 493
0 2 2 "0s" 0 0 0 193 0 0  1252.365759960593 471.8437901948785 1
2
LANG:10024 35 MS Shell Dlg 2,-1,19,5,75,0,0,0,0,0
LANG:10027 35 MS Shell Dlg 2,-1,11,5,50,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 644
"btn_novi_algoritam"
""
1 1017.352277789185 746.9444444444445 E E E 1 E 0 E N "WF_Text" E N "_Button" E E
 E E
405 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 35 MS Shell Dlg 2,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  1176 355 1311 409

T 
2
LANG:10024 12 PUSH_BUTTON2
LANG:10027 12 PUSH_BUTTON2
"#uses \"latin_to_cyrillic.ctl\"
main()
{
  ChildPanelOnRelativ(\"MAIN_PANELI/potvrda_algoritma_pozar.pnl\", latinToCyrillic(\"Potvrda komande\"),makeDynString(\"$PRIJEDLOG:\" + 1), 50, -90);
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"Pokreni algoritam\\nbez zagušenja\");
}" 0

15 657
"CLOCK1"
""
1 1100 -10 E E E 1 E 1 E N "WF_Text" E N "_Transparent" E E
 E E
406 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 31 Sans Serif,-1,12,5,50,0,0,0,0,0
LANG:10027 31 Sans Serif,-1,12,5,50,0,0,0,0,0
0  1100 -10 1400 130
E 1 0 "%H:%M:%S" "%x"
1 0 1 1
2
LANG:10024 32 DejaVu Sans,-1,64,5,50,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,64,5,50,0,0,0,0,0
0  2
LANG:10024 31 Sans Serif,-1,12,5,50,0,0,0,0,0
LANG:10027 31 Sans Serif,-1,12,5,50,0,0,0,0,0
0 
6 658
"RECTANGLE17"
""
1 210 30 E E E 1 E 0 E N "_Transparent" E N {153,153,153} E E
 E E
407 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  dpConnect(\"ukiniSelektovano\", \"ime.Alarm.dpElement\");
}

ukiniSelektovano(string dp_source, string dpe)
{
  if(dpe == \"\"){ 
     return; //nije selektovan nijedan alarm
  }
  else{
     //u slucaju da je selektovan alarm prati njegovo stanje
     dpConnect(\"promjenaDatapointa\", dpe + \":_alert_hdl.._act_state\");
  }
  
}
promjenaDatapointa(string dp_source, bool potvrda)
{
  string dpElement;
  dpGet(\"ime.Alarm.dpElement\", dpElement);
  dp_source = dpSubStr(dp_source, DPSUB_DP);   
  dpElement = dpSubStr(dpElement, DPSUB_DP);   
  if(dp_source != dpElement) return;
      
  if(potvrda){   //alarm i dalje prisutan ili nije potvrdjen
  }
  else {   // ako je alarm nestao i potvrdjen
    delay(1);
    dpSet(\"SysSarani:\"+\"ime.Alarm.dpElement\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.tip\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.objekat\",\"00\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.opis\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijednost\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.lazni\",0);
    }  
}

" 0
 E 0 1 1 2 1 E 1 0 1 1596.086333967759 990.0000000000002 1 E 210 30 330 90
2 585
"PRIMITIVE_TEXT4"
""
1 39.10613507150379 658.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
370 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Tip alarma:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 658.6736111111111 41 673
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 658.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
4 586
"LINE2"
""
1 409.3661602879099 682.1736111111111 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
371 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  409.3661602879099 682.1736111111111 39.91018912555774 682.1736111111111
4 587
"LINE3"
""
1 409.3661602879099 743.1736111111111 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
372 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  409.3661602879099 743.1736111111111 39.91018912555774 743.1736111111111
4 588
"LINE4"
""
1 409.3661602879099 801.1736111111111 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
373 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  409.3661602879099 801.1736111111111 39.91018912555774 801.1736111111111
4 589
"LINE5"
""
1 409.3661602879099 831.1736111111111 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
374 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  409.3661602879099 831.1736111111111 39.91018912555774 831.1736111111111
4 590
"LINE6"
""
1 409.3661602879099 861.1736111111111 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
375 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  409.3661602879099 861.1736111111111 39.91018912555774 861.1736111111111
2 592
"PRIMITIVE_TEXT5"
""
1 39.10613507150379 688.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
377 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Vreme alarma:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 688.6736111111111 41 703
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 688.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 593
"PRIMITIVE_TEXT6"
""
1 39.10613507150379 777.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
378 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Objekat pod alarmom:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 777.6736111111111 41 792
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 777.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 594
"PRIMITIVE_TEXT7"
""
1 39.10613507150379 807.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
379 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Opis alarma:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 807.6736111111111 41 822
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 807.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 595
"PRIMITIVE_TEXT8"
""
1 39.10613507150379 837.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
380 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Stanje alarma:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 837.6736111111111 41 852
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 837.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 597
"PRIMITIVE_TEXT10"
""
1 229.00816209853 658.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
382 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:ime.Alarm.tip:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:ime.Alarm.tip:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  string s;
  switch(sNewValue) {
    case \"I\":
      s = \"Informacija\";
      break;
    case \"W\":
      s = \"Upozorenje\";
      break;
    case \"Da\":
      s = \"Opasnost\";
      break;
    case \"A\":
      s = \"Alarm\";
      break;
    default: 
      s = sNewValue;
      break;
  }
  this.text = latinToCyrillic(s);
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}


" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 658.6736111111111 231 673
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 658.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 598
"PRIMITIVE_TEXT11"
""
1 229.00816209853 688.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
383 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"ime.Alarm.vrijeme:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.vrijeme:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  setValue(\"\", \"text\", latinToCyrillic(substr(sNewValue, 0, 19)));
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}




" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 688.6736111111111 231 703
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 688.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 599
"PRIMITIVE_TEXT12"
""
1 229.00816209853 807.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
384 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.opis:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.opis:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  setValue(\"\", \"text\", latinToCyrillic(dpValToString(dp, sNewValue, FALSE)));
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}




" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 807.6736111111111 231 822
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 807.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 600
"PRIMITIVE_TEXT13"
""
1 229.00816209853 837.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
385 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.stanje:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.stanje:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  
  string s;
  if (strpos(sNewValue, \"CAME\") >=0 || strpos(sNewValue, \"УСТН.\") >=0)
    s = \"Alarm aktivan\";
  if (sNewValue==\"\") {
    s=\"\";
  }
  else 
    s = \"Alarm neaktivan\";
  
  this.text = latinToCyrillic(s);
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}




" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 837.6736111111111 231 852
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 837.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 602
"PRIMITIVE_TEXT15"
""
1 229.00816209853 777.6736111111111 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
387 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  setValue(\"\", \"text\", latinToCyrillic(getNazivDetektora(dpSubStr(sNewValue, DPSUB_DP))));
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}




" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 777.6736111111111 231 792
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 777.6736111111111 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
13 603
"PUSH_BUTTON1"
""
1 119 993.6535187972037 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
388 0 0 0 0 0
E E E
0
3
LANG:10024 0 
LANG:10027 0 
LANG:10001 0 

0
2
LANG:10024 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  117 994 311 1051

T 
3
LANG:10024 34 Automatski izbacuj poslednji alarm
LANG:10027 65 Аутоматски избацуј послједњи аларм
LANG:10001 35 Automatski izbacuj posljednji alarm
"main()
{
 dpSet(\"SysSarani:\"+\"ime.Alarm.dpElement\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.tip\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.objekat\",\"00\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.opis\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.vrijednost\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.p\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.lazni\",0);
 PanelOffPanel(\"IzborScenarija\");
 sdShowBitmap(\"RECTANGLE3\",1,TRUE,\"crna.jpg\");
 dpSet(\"SysSarani:\"+\"ime.Alarm.zadnji\",1);
 dpSet(\"SysSarani:\"+\"ime.Alarm.blok\",0);
}


" 0
 E E "
bool provjera;
main()
{
  this.text = latinToCyrillic(\"AUTOMATSKO IZBACIVANJE \\nZADNJEG ALARMA\");
  EP_ucitaj_zadnji();
}

void EP_ucitaj_zadnji()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.zadnji:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_ucitaj_zadnjiCB\", 
                 \"SysSarani:\"+\"ime.Alarm.zadnji:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_ucitaj_zadnjiCB(string dpSource, bool boNewValue)
{
  if(boNewValue) this.backCol = \"green\";
  else this.backCol = \"\";
  provjera=boNewValue;
  
  //dpQueryConnectSingle(\"work\", 1, \"ident\", \"SELECT ALERT '_alert_hdl.._ackable' FROM '*' WHERE '_alert_hdl.._direction' == 1\");
  dpQueryConnectSingle(\"work\", 1, \"ident\", \"SELECT ALERT '_alert_hdl.._ackable' FROM '*' \", 500);
}

work(string ident, dyn_dyn_anytype tab)
{
 
  if(provjera){
    
  int                   i,trenutni, iLineNr, PriorRange, actState;
  string                dpElement;
  time                  ti;
  unsigned              ranges;
  bool                  moreRanges;
  dyn_time              times;
  dyn_int               ackState, realAckState, oldestAck, counts;
  dyn_string            dpes;
  
  atime At; 

  time vreme;

  for (i = 2; i <= dynlen(tab); i++ )                                   //This section creates the alert list.
  {                                                                     //Alerts with state \"came\" will be appended,
    dpElement = dpSubStr(tab[i][1], DPSUB_DP_EL);                       //others as \"acknowledged\" will be deleted.
    dpGet(dpElement+\":_online.._stime\",        ti,
          dpElement+\":_alert_hdl.._act_range\", PriorRange);
    dpGet(dpElement+\":_alert_hdl.\"+PriorRange+\"._act_state\",actState);
    dpGet(dpElement+\":_alert_hdl.._num_ranges\", ranges);
       
    if(ti>vreme)
    {
      trenutni=i;
      vreme=ti;
    }
  }

  anytype vrijednost;
  dpElement = dpSubStr(tab[trenutni][1], DPSUB_DP_EL);                       //others as \"acknowledged\" will be deleted.
    dpGet(dpElement+\":_online.._stime\",        ti,
          dpElement+\":_alert_hdl.._act_range\", PriorRange);
    dpGet(dpElement+\":_alert_hdl.\"+PriorRange+\"._act_state\",actState);
    dpGet(dpElement+\":_alert_hdl.._num_ranges\", ranges);
    
    dpGet(dpElement+\":_online.._value\",  vrijednost);
  At= makeATime(ti, 0, dpElement);
  //make sure acknowledging is needed 
 // if (PriorRange != 0) 
  time potvrda;
  langString tip,text;
   bool id;
  int ack;
  string koment;
  alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._abbr\", tip);
  char range;
  alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._prior\", range);
  alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._ack_state\", ack);
  alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._ack_time\", potvrda);
  alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._comment\", koment);
  
  //ovo ubaceno za tekst
  dpGet(dpElement+\":_alert_hdl.._num_ranges\", ranges);
  
  dpGet(dpElement+\":_alert_hdl.\"+ranges+\"._text\",text);
  //dpGet(dpElement+\":_alert_hdl.\"+PriorRange+\"._act_state_text\",text);
 DebugN(\"ACT STATEEEEEEEEEEE \",actState );
 
 DebugN(\"priorRange \",PriorRange );

alertGet(At, getACount(At), dpElement+\":_alert_hdl.\"+PriorRange+\"._direction\", id);
 



  DebugN(\"tip  \"+ tip);
  
  DebugN(\"text  \"+ text);
  DebugN(\"vremeeeeeee  \"+ ti);
  
  DebugN(\"range  \"+ range);
  
  DebugN(\"ack  \"+ ack);
  
  DebugN(\"potvrda  \"+ potvrda);
  
  DebugN(\"id  \"+ id);
  
  DebugN(\"komentar  \"+ koment);
  
  DebugN(\"element  \"+ dpElement);
  
  DebugN(\"vrijednost  \"+ vrijednost);
  
  dpSet(\"SysSarani:\"+\"ime.Alarm.tip\",tip);
  
  if(range==\"<\")dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"60\");
  else if(range==\"2\")dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"50\");
  else if(range==\"Z\")dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"90\");
  else if(range==\"P\")dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"80\");
  else if(range==\"F\")dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"70\");
  
  dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme\", ti);
  
  dpSet(\"SysSarani:\"+\"ime.Alarm.dpElement\",dpElement);
  
  dpSet(\"SysSarani:\"+\"ime.Alarm.objekat\",dpElement);
  
  dpSet(\"SysSarani:\"+\"ime.Alarm.opis\", text); 
  
  if(id)dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"CAME\");
  else dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"WENT\");
   
 

  
  dpSet(\"SysSarani:\"+\"ime.Alarm.vrijednost\",vrijednost);
  
  if(ack==0){dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",\"\");dpSet(\"SysSarani:\"+\"ime.Alarm.lazni\", 0);}
  else dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",potvrda);
  
  if (koment==\"\")dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"\");
  else dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"1\");
  
}
}




" 0

13 604
"PUSH_BUTTON24"
""
1 -406.0718562874251 1116.286403205968 E E E 1 E 1 E N "WF_Text" E N "_Button" E E
 E E
389 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

0
2
LANG:10024 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,12,5,75,0,0,0,0,0
0  117 917 312 974

T 
2
LANG:10024 19 POTVRDA SVIH ALARMA
LANG:10027 13 PUSH_BUTTON24
"main()
{
  string upit, dpElement;
  int i, actState;
  dyn_dyn_anytype ispis;

  upit = \" SELECT ALERT '_alert_hdl.._value' FROM '*'\" ;
  
  //nadji sve datapoint elemente u alarmu
  dpQuery(upit, ispis);

  for (i = 2; i <= dynlen(ispis); i++ )                                   
  {                                                                     
    dpElement = dpSubStr(ispis[i][1], DPSUB_ALL);
    dpGet(dpElement + \":_alert_hdl.._act_state\", actState);

    if(actState==1 || actState==3){
      dpSet(dpElement + \":_alert_hdl.._ack\", true);
    }

  }
  
    
    
    
    DebugTN(\"Pozvan ack remote system 1\");
    ack_remote_system_alarms(\"SysSavinac\");
//     ack_remote_system_alarms(\"SysBrdjani\");
//     ack_remote_system_alarms(\"SysKik\");    
    
    dpSet(\"SysSarani:\"+\"ime.Alarm.dpElement\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.tip\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.prioritet\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.objekat\",\"00\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.opis\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.stanje\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijednost\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.vrijeme_p\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.kom\",\"\");
    dpSet(\"SysSarani:\"+\"ime.Alarm.lazni\",0);
}

ack_remote_system_alarms(string sRemote_sysName)
{
  DebugTN(\"Pozvan ack remote system\");
    string upit, dpElement;
  int i, actState;
  dyn_dyn_anytype ispis;

  upit = \" SELECT ALERT '_alert_hdl.._value' FROM '*' REMOTE '\" + sRemote_sysName + \":'\";
  
  //nadji sve datapoint elemente u alarmu
  dpQuery(upit, ispis);

  for (i = 2; i <= dynlen(ispis); i++ )                                   
  {                                                                     
    dpElement = dpSubStr(ispis[i][1], DPSUB_ALL);
    dpGet(dpElement + \":_alert_hdl.._act_state\", actState);

    if(actState==1 || actState==3){
      dpSet(dpElement + \":_alert_hdl.._ack\", true);
      
      DebugTN(\"Uradjen dpSet ack remote system\");
    }
  }
}" 0
 E E "main()
{
  this.text = latinToCyrillic(\"POTVRDA SVIH \\nALARMA\");
}" 0

4 606
"LINE8"
""
1 410 649.6519511120158 E E E 1 E 1 E N "WF_Text" E N {255,255,255} E E
 E E
391 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  410 649.6519511120159 40.5440288376476 649.6519511120159
2 608
"PRIMITIVE_TEXT17"
""
1 217.788427896113 619.1041666666667 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
393 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"SELEKTOVANI ALARM\");
}" 0
 E 0 1 3 2 1 E U  0 E 217.788427896113 619.1041666666667 219 637
0 2 2 "0s" 0 0 0 193 0 0  217.788427896113 619.1041666666667 1
2
LANG:10024 35 MS Shell Dlg 2,-1,16,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,16,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
4 624
"LINE9"
""
1 410 712.3480488879841 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
397 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  410 712.3480488879841 40.5440288376476 712.3480488879841
4 627
"LINE10"
""
1 410 773 E E E 1 E 1 E N "STD_grey_middle" E N {255,255,255} E E
 E E
400 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
E E 2 1 3 2 1 E  410 773 40.5440288376476 773
2 628
"PRIMITIVE_TEXT18"
""
1 39.10613507150379 720.6805555555554 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
401 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Sistem:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 720.6805555555554 41 735
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 720.6805555555554 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 629
"PRIMITIVE_TEXT19"
""
1 39.10613507150379 750.6805555555554 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
402 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
  this.text = latinToCyrillic(\"Tip objekta:\");
}" 0
 E 0 1 3 2 1 E U  0 E 39.10613507150379 750.6805555555554 41 765
0 2 2 "0s" 0 0 0 192 0 0  39.10613507150379 750.6805555555554 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 630
"PRIMITIVE_TEXT20"
""
1 229.00816209853 720.6805555555554 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
403 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  string  s = dpSubStr(sNewValue, DPSUB_SYS);
  string sistem;
  switch(s) {
    case \"SysSarani:\":
        sistem = \"Šarani\";
        break;
    case \"SysBrdjani:\":
        sistem = \"Brđani\";
        break;
    case \"SysSavinac:\":
        sistem = \"Savinac\";
        break;
    case \"SysKik:\":
        sistem = \"Veliki Kik\";
        break;
    default:
        sistem = s;
        break;
  }
  
  this.text = latinToCyrillic(sistem);
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}




" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 720.6805555555554 231 735
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 720.6805555555554 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
2 631
"PRIMITIVE_TEXT21"
""
1 229.00816209853 750.6805555555554 E E E 1 E 1 E N "WF_Text" E N "_Window" E E
 E E
404 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// SimpleCtrlScriptStart {invalid}
main()
{
  EP_textFieldIn();
}

void EP_textFieldIn()
{
  int rc;

  if( !dpExists( \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\"))
  {
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
    return;
  }

  rc = dpConnect(\"EP_textFieldInCB\",
                 \"SysSarani:\"+\"ime.Alarm.dpElement:_online.._value\");

  if ( sdGetLastError() < 0 || rc != 0)
    setValue(\"\", \"color\", \"_dpdoesnotexist\");
}


void EP_textFieldInCB(string dp, string sNewValue)
{
  string  s = dpSubStr(sNewValue, DPSUB_SYS_DP);
  
  string tip_objekta;
  
  if(dpExists(s + \".tip_objekta\")) {
    dpGet(s + \".tip_objekta\", tip_objekta);
  }
  
  
  
  
  //if (dpExists(dpGet(s + \".tip_objekta\", tip_objekta)));
  
  this.text = latinToCyrillic(tip_objekta);
}

// SimpleCtrlScript {EP_textFieldIn}
// DP {SysVijenac:ime.Alarm.tip}
// DPConfig {:_online.._value}
// DPType {string}
// UseDPUnit {FALSE}
// UseDPFormat {TRUE}
// SimpleCtrlScriptEnd {EP_textFieldIn}





" 0
 E 0 1 3 2 1 E U  0 E 229.00816209853 750.6805555555554 231 765
0 2 2 "0s" 0 0 0 192 0 0  229.00816209853 750.6805555555554 1
2
LANG:10024 35 MS Shell Dlg 2,-1,13,5,75,0,0,0,0,0
LANG:10027 32 DejaVu Sans,-1,13,5,75,0,0,0,0,0
0 2
LANG:10024 0 
LANG:10027 0 
10 671
"btn_back"
""
1 190 70 E E E 1 E 1 E N {0,0,0} E N "STD_grey_middle" E E
 E E
408 0 0 0 0 0
E E E
0
2
LANG:10024 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "1"
"main()
{
//   this.visible = false;
//   this.visible = (strpos(panelFileName(myModuleName(), myPanelName()),\"main_panel\")>=0) ? 0 : 1;
}" 0
 "#uses \"latin_to_cyrillic.ctl\"
main()
{
  RootPanelOnModule(\"MAIN_PANELI/Konzola_main_panel.pnl\",\"Početni panel\",\"Module1\",\"\"); 
  
}
" 0
 0 1 3 2 1 E 1 0 0.4887404511060432 -108 -5.761449621664752 1 E 9 190 70
190 70
190 70
160 70
160 50
130 80
160 110
160 90
190 90
 1
0
LAYER, 1 
2
LANG:10024 6 Layer2
LANG:10027 6 Layer2
0
LAYER, 2 
2
LANG:10024 6 Layer3
LANG:10027 6 Layer3
0
LAYER, 3 
2
LANG:10024 6 Layer4
LANG:10027 6 Layer4
0
LAYER, 4 
2
LANG:10024 6 Layer5
LANG:10027 6 Layer5
0
LAYER, 5 
2
LANG:10024 6 Layer6
LANG:10027 6 Layer6
0
LAYER, 6 
2
LANG:10024 6 Layer7
LANG:10027 6 Layer7
0
LAYER, 7 
2
LANG:10024 6 Layer8
LANG:10027 6 Layer8
0
3 0 "PANEL_REF0" -1
"" ""
"vision/aes/AESRow.pnl" 76 1240 T 287 0.8929303728677924 0 16.42857142857143 14.92671871882246 -188.5714285714286
1
"$SCREENTYPE""aes_propSarani"
1 3 "SHAPE_GROUP3" -1
30 0 
523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 558 560 561 562 563 605 644 

"" ""
0
